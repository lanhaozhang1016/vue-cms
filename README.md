# 这是一个基于vue的项目 是一个包含新闻页面 、购物页面等等方面的应用程序
## 其中的数据来源于数据库，是假数据，是为了用来渲染页面
### 希望通过此次项目能学到呢更多的知识
#### 接下来，我将介绍该项目的一些知识点和经验总结

## [主流开源协议之间有何异同？](https://www.zhihu.com/question/19568896)

## 第一次把本地项目托管到github上
1. 首先需要注册一个github账号
2. 创建一个空的仓储 new repository 
3. 在本地项目中操作命令行 git add .    git commit -m "init my project" 将项目存储到本地仓库.git文件夹中
4. 然后按照github的提示操作两条命令行
5. note: 此时git报错-fatal: HttpRequestException encountered.
6. 原因： Github禁用了TLS v1.0 and v1.1，必须更新Windows的git凭证管理器才可以 
7. 解决方案：下载安装GCMW-1.20.0.exe （最新版即可）

## 用(传统方式)命令行把修改过后的代码上传到码云（github）
1. git add .
2. git commit -m "提交信息"
3. git push
## 入口文件代码编写
1. 导入各种文件 样式 模块
2. 创建vm实例
## 路由文件代码编写 
1. 导入对应的路由组件
2. 创建路由对象
3. 向外暴露路由对象
## 制作首页App组件
1. 完成 Header 区域，使用的是 Mint-UI 中的Header组件
2. 制作底部的 Tabbar 区域，使用的是 MUI 的 Tabbar.html 
 + 首先导入mui样式文件
 + 这些小图标使用的是MUI的icons.html 和 icons-extra.html
 + 在制作 购物车 小图标的时候，操作会相对多一些：
 + 先把 扩展图标的 css 样式，拷贝到 项目中
 + 拷贝 扩展字体库 ttf 文件，到项目中
 + 为 购物车 小图标 ，添加 如下样式 `mui-icon mui-icon-extra mui-icon-extra-cart` 
3. 要在 中间区域放置一个 router-view 来展示路由匹配到的组件

## 改造 tabbar 为 router-link 并将 herf 属性改为 to 

## 设置路由高亮 也就是在路由对象中设置linkActiveClass属性为那个active类名

## 点击 tabbar 中的路由链接，展示对应的路由组件

## 制作首页轮播图布局

## 加载首页轮播图数据
 ### 这里数据库出了问题 所以就没有用数据库的图片，而是预先准备的图片 属于假数据 不能跟后台交互 也不能修改
1. 获取数据， 如何获取呢， 使用 vue-resource
2. 使用 vue-resource 的 this.$http.get 获取数据
3. 获取到的数据，要保存到 data 身上
4. 使用 v-for 循环渲染 每个 item 项

## 改造 九宫格 区域的样式
 1. 这里使用的是MUI中的grid-default.html
 2. 只留下6个li
 3. 将图标icon改为图片 设置图片的高度和宽度
 4. 将大盒子的背景色改为白色
 5. 将各个盒子的边框清除
## 设置组件间的切换动画效果
### 出现了以下几个问题
1. 顶部跟着动画一起跑
2. 底部跟着动画一起跑 以上两个问题是因为页面出现了滚动条，因为做动画的时候，切换组件，另一个组件已经在一边等着了
3. 动画从同一个方向进入离开 将v-enter 和v-leave-to 的样式分开写
4. 动画先水平进入，然后垂直上升 在v-leave-to的样式里面加position： absolute
## 六宫图改造之新闻资讯子页面
### 由a标签改至router-link 并且将href属性改为to，且对应的值改为跳转的组件
## 制作新闻列表页面组件
1. 首先使用MUI中的media-list.html
2. 因为新闻内容都在数据库中，所以要从数据库中加载数据 要发送ajax异步请求 所以要使用vue-resource
3. 为了方便，设置请求的根路径 Vue.http.options.root = ''
4. 获取数据之后，要遍历 所以要使用v-for 为了表示唯一性 所以要绑定:key值
5. 由于值为一个变量 所以前面的src是需要绑定上去的，不能少了：    :src="item.img_url"
6. padStart()是ES6新增的字符串的方法，所以要使用的对象必须转换成字符串，多通过toString()方法进行转换
## 改造新闻列表跳转到新闻详情
1. 因为该跳转是根据用户点击的某一条新闻然后跳转到对应的新闻详情，所以要设置一个联系两边的标记，通常是id
2. 在改造新闻列表路由链接时，to的值也要变成/home/newsinfo/item.id 因为id是变量，所以to是需要绑定的 :to
3. 创建新闻资讯详情页面的组件
4. 在路由模块router.js中，将 新闻详情的 路由地址 和 组件页面匹配起来  /home/newsinfo/:id 是根据id跳转
5. 由于数据库是别人提供的 我没有资格修改 部分数据因为时间原因已经丢失 所以部分图片已经不能显示
## 在新闻详情页面添加评论子组件 
1. 创建评论子组件，绘制其样式
2. 将子组件导入新闻详情页面中
3. 获取数据库中的评论内容，渲染在页面中
### 获取数据库里面的内容时，要根据新闻的不同而获取相应的评论 所以评论子组件需要拿到新闻详情的id值
### 父组件向子组件传值，通过属性绑定的方法实现
### 实现功能： 点击加载更多按钮 获取多页评论内容
1. 首先创建一个点击加载更多的按钮   给他注册点击事件 事件内容就是 pageIndex+1 再重新获取下一页的数据
2. 此时因为获取的是下一页的数据 如果对获取的结果还是简单的赋值给数组，那么前面页码的评论将会消失不见
3. 所以解决方法就是进行一个数组的拼接，采用数组的concat()
4. 有一点需要优化 就是如果你加载的页面超过了数据库里面所有数据 那么应该怎么处理 至少此时应该停止加载，并且提示无法加载更多数据

### 实现功能： 发表匿名用户评论
1. 首先对于textarea进行双向数据绑定 v-model 并且在对象中加上一个属性
2. 对于发表评论按钮 注册点击事件 
3. 事件的内容就是 利用vue-resource发送post请求，将评论内容提交给服务器 在此之前 需要校验评论内容是否为空，如果为空，则Toast提示用户 评论内容不能为空
4. 当发表评论OK后，重新刷新列表，以查看最新的评论
 + 如果调用 getComments 方法重新刷新评论列表的话，可能只能得到 最后一页的评论，前几页的评论获取不到 因为如果此时的pageIndex > 1 则重=重新渲染 前面的数据就都获取不到了
 + 换一种思路： 当评论成功后，在客户端，手动拼接出一个 最新的评论对象，然后 调用 数组的 unshift 方法， 把最新的评论，追加到  data 中 comments 的开头；这样，就能 完美实现刷新评论列表的需求；
5. 最后需要把textarea里面的内容清空 等待下一次发表评论
### 六宫格改造之图片分享子页面
1. 首先是将a->router-link 并且设置to属性
2. 创建图片分享子组件
3. 在路由文件中添加桥梁
4. 制作图片分享页面的结构和样式
###制作图片列表组件 结构和样式
#### 顶部滑动条制作
1. 首先在mui中找到并使用tab-top-webview-main.html的相应结构
+ 使用过程中发现的坑以及解决方法
 + 图片分类不在期望的位置 而是覆盖在顶部的标题上 检查元素 去掉它全屏的类 mui-fullscreen 即可 
 + 图片分类不可以正常触发滑动 检查MUI官方文档 scroll组件属于js组件 它需要手动导入mui.js文件 并且按照官方文档手动初始化
  + ../../lib/mui/js/mui.js 
   + 此时报错 bundle.js:33915 Uncaught TypeError: 'caller', 'callee', and 'arguments' properties may not be accessed on strict mode functions or the arguments objects for calls to them
   + 经过我们合理的推测，觉得，可能是 mui.js 中用到了 'caller', 'callee', and 'arguments' 东西，但是， webpack 打包好的 bundle.js 中，默认是启用严格模式的，所以，这两者冲突了；
   + 解决方案： 1. 把 mui.js 中的 非严格 模式的代码改掉；但是不现实； 2. 把 webpack 打包时候的严格模式禁用掉；
   + 最终，我们选择了移除严格模式： 使用这个插件 babel-plugin-transform-remove-strict-mode
   + 使用方法 [babel-plugin-transform-remove-strict-mode](https://github.com/genify/babel-plugin-transform-remove-strict-mode)
  + 初始化scroll控件：
    mui('.mui-scroll-wrapper').scroll({
    	deceleration: 0.0005 //flick 减速系数，系数越大，滚动速度越慢，滚动距离越小，默认值0.0006
    });
   + 刚进入 图片分享页面的时候， 滑动条无法正常工作，必须要重新刷新一下才可以正常滑动
   + 分析： 初始化scroll控件 要使用scroll() 必须要等DOM元素加载完毕 注意是DOM元素，不是vm的数据 所以得在mounted()钩子函数中调用
    经过我们认真的分析，发现， 如果要初始化 滑动条，必须要等 DOM 元素加载完毕，所以，我们把 初始化 滑动条 的代码，搬到了 mounted 生命周期函数中；
   + 滑动条问题解决了，结果发现tabbar 无法正常切换页面了 
   + 解决方法不知道是哪里来的 可能是经过百般尝试的出来的经验 
   + 我们需要把 每个 tabbar 按钮的 样式中  `mui-tab-item` 重新改一下名字 并且在改名字之前要把所有对应的样式都重新手动写出来
2. 获取所有分类，并渲染 分类列表；
####点击图片就跳转到图片分享详情页面
1. 首先是改造router-link
2. 绘制图片分享详情的页面组件（包含缩略图）
+ 缩略图有现成的组件 npm 搜索 vue-preview 就有使用方法
+ 在npm i vue-preview -S 的时候出了问题，Error: Maximum call stack size exceeded 百度解决方法 给出了npm降维和升维两种方法，我都一一尝试，最终是降维解决了问题
+ vue-preview的使用与之前不同了，用的时候是通过百度学习的 首先在获取缩略图时要给大图设置宽高，还要给图片地址赋值 给出了新的属性 msrc 不是img_url,也不是src
+ 在style中给小图设置样式时，也有一个坑，就是设置的样式无效，这是由于scoped的问题，所以去掉他就可以实现了
### 改造商品列表
1. 改造路由
2. 制作经典的两列布局 手写 利用弹性盒子，其中有很多知识点值得学习
## 
###尝试在手机上 去进行项目的预览和测试
1. 要保证自己的手机可以正常运行；
2. 要保证 手机 和 开发项目的电脑 处于同一个 WIFI 环境中，也就是说 手机 可以 访问到 电脑的 IP
3. 打开自己的 项目中 package.json 文件，在 dev 脚本中，添加一个 --host 指令， 把 当前 电脑的 WIFI IP地址， 设置为 --host 的指令值；
 + 如何查看自己电脑所处 WIFI 的IP呢， 在 cmd 终端中运行 `ipconfig` ， 查看 无线网的 ip 地址
### 商品购买页面制作
#### 商品列表页面制作
1. 利用弹性盒子，设计经典两列布局 大盒子display: flex justify-content: space-between 
2.  小盒子宽度必须设置为接近50% （49%） 这样才是1/2 两列分布 33% 就是三列分布
3. 小盒子分成3部分 从上至下 图片盒子 标题盒子 信息盒子 
4. 图片盒子里面放商品图片 图片宽度必须设置成100% 因为网络加载问题，图片盒子必须设置最小高度
5. 为了对齐分布好看 那个小盒子要设置成上下分布的形式 dispaly: flex flex-direction: column justify-content: space-between 
#### 商品详情页面制作
1. 点击商品列表的盒子 页面跳转到商品详情页面 一般有两种跳转方式
2. 两种跳转方式: 
 - 使用a标签形式叫做标签跳转 或者将a标签改造成router-link tag="a"
 - 使用window.location.href的形式叫做[编程式导航]https://router.vuejs.org/zh/guide/essentials/navigation.html
   1. router 是 new VueRouter()的实例对象
   2. 用vue提供的方法可以使用this.$router
   3. 如果地址栏看到请求参数 也就是 地址？参数=参数值 则使用 用vue提供的方法可以使用this.$router.push({path: '/xxx', query:{id})
   4. 如果地址栏看不到请求参数 也就是 地址/参数值 则使用 用vue提供的方法可以使用this.$router.push({name: 'xxx', params:{id}) 此时的name是在导入组件时，自己命名的
   5. 这个通常是注册一个点击事件，然后把编程式导航代码写在时间处理函数里，然后跳转到请求页面
3. 商品详情页面的布局是使用mui card.html 卡片布局 三个卡片 第一个是轮播图 第二个是 第三个是
4. 因为项目首页就用了一次轮播图 所以将轮播图抽离出来组成一个轮播图子组件 轮播的数据数组列表通过父组件向子组件传值的方式进行
5. 在不同的页面中，轮播图中的图片设置是不同的 其它方面都是没有冲突的，只是 宽度有分歧， 那么，我们可以定义一个 属性，让 使用轮播图的 调用者，手动指定 是否为 100%  实现方式是创建一个是否宽度100%的样式类，然后父组件传递判断值 true false 来控制宽度是100%还是自适应
##### 在详情页面制作过程中需要解决的几个问题
1. 点击跳转到图文介绍页面  
2. 点击加载更多商品评价
3. 点击加入购物车 小球动画制作 并且红点处数字+1  
4. 那个购买数量的变化 以及number-box 组件抽离   
 - number-box 使用的 mui number.html 在mounted生命周期函数中初始化 具体看[mui官方文档]https://dev.dcloud.net.cn/mui/ui/#numbox
 - number-box 组件抽离简单 
 - 操作 + - 或者直接改变数字 使得购买数量发生变化 当触发到数字变化，使父组件获取到子组件的数量 子组件想父组件传值
 - 库存数量决定 最大可加入购物车数量 父组件向子组件传值 此时因为获取到库存数量的操作是异步操作，所以不知道什么时候才能获取到库存值，所以平常使用的父组件向子组件传值的方法是不可用的
   虽然不知道什么时候可以获取到真正的最大值 但是一定会获取到这个值是真的 所以只需要一直监听max的变化 直到最后一次变化的值就一定是真正的最大值 此时将这个动态变化的最大值传递给max即可
   因为采用watch属性监听，要使用js api 所以具体实现方法还是参照mui number box 官方文档
5. 点击立即购买 跳转到什么界面呢 
##### 图文介绍页面制作
